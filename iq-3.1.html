<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verbal Aptitude Test – 90 MCQs</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #1e88e5;
      --correct: #4caf50;
      --wrong: #f44336;
      --bg-light: #f5f7fa;
      --text-dark: #2d3748;
      --card-bg: #ffffff;
      --border: #e2e8f0;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to right, #e6f0fa, #f0f9ff);
      color: var(--text-dark);
      line-height: 1.6;
      padding: 2rem;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .quiz-container {
      max-width: 1000px;
      width: 100%;
      background: var(--card-bg);
      border-radius: 12px;
      padding: 2.5rem;
      box-shadow: var(--shadow);
      transition: transform 0.3s ease;
    }

    .quiz-container:hover {
      transform: translateY(-5px);
    }

    h1 {
      text-align: center;
      color: var(--primary);
      font-size: 2.5rem;
      margin-bottom: 1rem;
      font-weight: 700;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }

    h2.section-title {
      color: #d81b60;
      margin: 2rem 0 1rem;
      border-bottom: 2px solid var(--border);
      padding-bottom: 0.5rem;
      font-size: 1.8rem;
    }

    .question {
      margin-bottom: 2rem;
      padding: 1.5rem;
      border-radius: 8px;
      background: #f7fafc;
      border: 1px solid var(--border);
      animation: fadeIn 0.5s ease-out;
    }

    .question:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .question p {
      font-weight: 600;
      font-size: 1.2rem;
      margin-bottom: 1rem;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .options button {
      background: var(--bg-light);
      border: 2px solid var(--border);
      border-radius: 6px;
      padding: 0.75rem 1.25rem;
      font-size: 1rem;
      color: var(--text-dark);
      cursor: pointer;
      text-align: left;
      transition: all 0.3s ease;
    }

    .options button:hover:not(.disabled) {
      background: #edf2f7;
      border-color: var(--primary);
      transform: translateX(4px);
    }

    .options button:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.5);
    }

    .correct {
      background: #c6f6d5 !important;
      border-color: #68d391 !important;
      color: #22543d;
      animation: pulse 0.5s;
    }

    .wrong {
      background: #fed7d7 !important;
      border-color: #f56565 !important;
      color: #742a2a;
      animation: shake 0.3s;
    }

    .disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-4px); }
      75% { transform: translateX(4px); }
    }

    .explanation {
      background: #edf2f7;
      padding: 1rem;
      margin-top: 1rem;
      border-radius: 6px;
      border-left: 4px solid var(--primary);
      font-size: 0.95rem;
      display: none;
    }

    .explanation.show {
      display: block;
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      background: #edf2f7;
      border-radius: 6px;
      margin-bottom: 1.5rem;
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .progress {
      height: 100%;
      background: linear-gradient(to right, var(--primary), #1565c0);
      border-radius: 6px;
      transition: width 0.4s ease-in-out;
    }

    #timer {
      text-align: right;
      font-size: 1.1rem;
      margin-bottom: 1rem;
      color: #c53030;
      font-weight: 600;
    }

    #score, #results {
      text-align: center;
      font-size: 1.5rem;
      margin-top: 2rem;
      font-weight: 700;
    }

    .results-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 1.5rem;
      font-size: 0.95rem;
      background: var(--card-bg);
      border-radius: 8px;
      overflow: hidden;
    }

    .results-table th, .results-table td {
      border: 1px solid var(--border);
      padding: 1rem;
      text-align: left;
    }

    .results-table th {
      background: #edf2f7;
      font-weight: 600;
    }

    .results-table td.correct { color: #2f855a; font-weight: 600; }
    .results-table td.wrong { color: #c53030; font-weight: 600; }
    .results-table td.skipped { color: #d69e2e; font-weight: 600; }
    .results-table td.not-attempted { color: #718096; }

    .skip-button {
      background: #fff3cd;
      margin-top: 1rem;
      padding: 0.75rem;
      width: 100%;
      border: 2px solid #ffca28;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .skip-button:hover:not(.disabled) {
      background: #ffecb3;
      transform: translateY(-2px);
    }

    .skip-button.disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .pagination {
      display: flex;
      justify-content: space-between;
      margin-top: 1.5rem;
      gap: 1rem;
    }

    .pagination-button {
      background: var(--primary);
      color: #fff;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.3s ease;
    }

    .pagination-button:hover:not(:disabled) {
      background: #1565c0;
    }

    .pagination-button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .end-button, .restart-button {
      background: var(--primary);
      color: #fff;
      padding: 1rem 2rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 1.5rem;
      width: 100%;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .end-button:hover:not(:disabled), .restart-button:hover:not(:disabled) {
      background: #1565c0;
      transform: translateY(-2px);
    }

    .end-button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .hidden {
      display: none;
    }

    @media (max-width: 768px) {
      .quiz-container {
        padding: 1.5rem;
      }
      .question p {
        font-size: 1.1rem;
      }
      .options button, .skip-button {
        font-size: 0.95rem;
        padding: 0.6rem 1rem;
      }
      .results-table th, .results-table td {
        padding: 0.75rem;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      .quiz-container {
        padding: 1rem;
      }
      h1 {
        font-size: 2rem;
      }
      h2.section-title {
        font-size: 1.5rem;
      }
      .end-button, .restart-button {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h1>Verbal Aptitude Test – 90 MCQs</h1>
    <div id="timer">Time: 00:00</div>
    <div class="progress-bar">
      <div class="progress" id="progress"></div>
    </div>
    <div id="quiz" role="region" aria-live="polite"></div>
    <div class="pagination">
      <button class="pagination-button" id="prev-page" disabled aria-label="Previous Page">Previous</button>
      <button class="pagination-button" id="next-page" aria-label="Next Page">Next</button>
    </div>
    <button class="end-button" id="end-button" disabled aria-label="End Quiz">End Quiz</button>
    <div id="score"></div>
    <div id="results" class="hidden">
      <h2>Quiz Results</h2>
      <div style="overflow-x: auto;">
        <table class="results-table">
          <thead>
            <tr>
              <th>Question</th>
              <th>Your Answer</th>
              <th>Correct Answer</th>
              <th>Status</th>
              <th>Explanation</th>
            </tr>
          </thead>
          <tbody id="results-body"></tbody>
        </table>
      </div>
    </div>
    <button class="restart-button hidden" id="restart-button" aria-label="Restart Quiz">Restart Quiz</button>
  </div>

  <audio id="correct-sound" src="https://www.soundjay.com/buttons/beep-01a.mp3"></audio>
  <audio id="wrong-sound" src="https://www.soundjay.com/buttons/beep-02.mp3"></audio>

  <script>
    const questions = [
      { id: 1, section: "Synonyms", text: "What is the synonym of “Enormous”?", options: ["Tiny", "Huge", "Average", "Small"], correct: "Huge", explanation: "A synonym is a word with the same or similar meaning. “Enormous” means very large. Among the options, “Huge” also means very large, making it the correct synonym. “Tiny” and “Small” are antonyms, and “Average” indicates a medium size, which doesn’t match." },
      { id: 2, section: "Antonyms", text: "Choose the antonym of “Generous”.", options: ["Kind", "Selfish", "Helpful", "Caring"], correct: "Selfish", explanation: "An antonym is a word with the opposite meaning. “Generous” means giving freely. “Selfish” means concerned only with oneself, the opposite behavior. “Kind,” “Helpful,” and “Caring” are similar to generous, so they are incorrect." },
      { id: 3, section: "Word Meaning", text: "What does “Candid” mean?", options: ["Deceptive", "Honest", "Reserved", "Angry"], correct: "Honest", explanation: "“Candid” describes someone who is truthful and straightforward. “Honest” matches this meaning. “Deceptive” (misleading), “Reserved” (quiet), and “Angry” (upset) do not fit the definition." },
      { id: 4, section: "Synonyms", text: "Which word is closest in meaning to “Persevere”?", options: ["Give up", "Persist", "Hesitate", "Ignore"], correct: "Persist", explanation: "“Persevere” means to continue despite difficulties. “Persist” means to keep going, making it the closest synonym. “Give up” is the opposite, “Hesitate” means to pause, and “Ignore” means to disregard, none of which match." },
      { id: 5, section: "Antonyms", text: "The opposite of “Optimistic” is:", options: ["Hopeful", "Pessimistic", "Cheerful", "Confident"], correct: "Pessimistic", explanation: "“Optimistic” means expecting positive outcomes. “Pessimistic,” meaning expecting negative outcomes, is the antonym. “Hopeful” and “Cheerful” are similar to optimistic, and “Confident” is unrelated to optimism’s outlook." },
      { id: 6, section: "Synonyms", text: "What is a synonym for “Vivid”?", options: ["Dull", "Bright", "Vague", "Ordinary"], correct: "Bright", explanation: "“Vivid” describes something clear, intense, or lively (e.g., vivid colors). “Bright” matches this, especially for colors or imagery. “Dull” and “Vague” are opposites, and “Ordinary” means common, not intense." },
      { id: 7, section: "Word Meaning", text: "What does “Mitigate” mean?", options: ["Increase", "Reduce", "Ignore", "Create"], correct: "Reduce", explanation: "“Mitigate” means to make something less severe or intense (e.g., mitigate pain). “Reduce” fits this meaning. “Increase” is the opposite, “Ignore” means to overlook, and “Create” is unrelated." },
      { id: 8, section: "Antonyms", text: "Choose the antonym of “Fragile”.", options: ["Weak", "Delicate", "Strong", "Soft"], correct: "Strong", explanation: "“Fragile” means easily broken or delicate. “Strong,” meaning sturdy or durable, is the opposite. “Weak” and “Delicate” are similar to fragile, and “Soft” refers to texture, not strength." },
      { id: 9, section: "Word Meaning", text: "Which word means “to criticize harshly”?", options: ["Praise", "Condemn", "Support", "Encourage"], correct: "Condemn", explanation: "To “criticize harshly” means to strongly disapprove. “Condemn” means to express strong disapproval, fitting the definition. “Praise,” “Support,” and “Encourage” are positive actions, opposite to criticism." },
      { id: 10, section: "Synonyms", text: "A synonym for “Obsolete” is:", options: ["Modern", "Outdated", "Useful", "Current"], correct: "Outdated", explanation: "“Obsolete” means no longer in use or out of date. “Outdated” has the same meaning. “Modern” and “Current” are opposites, and “Useful” is unrelated to obsolescence." },
      { id: 11, section: "Sequence", text: "What comes next in the sequence: apple, banana, cherry, date, __?", options: ["Egg", "Elephant", "Evening", "Earth"], correct: "Egg", explanation: "The sequence follows alphabetical order based on the first letter: apple (A), banana (B), cherry (C), date (D). The next word starts with E. Among the options, “Egg” starts with E and is a simple noun, fitting better than “Elephant,” “Evening,” or “Earth,” which are less consistent with the pattern (common nouns)." },
      { id: 12, section: "Sequence", text: "Find the next term: big, small, tall, short, __?", options: ["Large", "Wide", "Narrow", "Long"], correct: "Long", explanation: "The sequence alternates size-related adjectives, with pairs of opposites: big (large), small (opposite), tall (large), short (opposite). The next term should be a “large” size adjective. “Long” fits as a size descriptor, while “Large” repeats big, “Wide” is less specific, and “Narrow” is an opposite." },
      { id: 13, section: "Sequence", text: "What is the next word: red, blue, green, yellow, __?", options: ["Orange", "Purple", "Black", "White"], correct: "Orange", explanation: "The sequence lists common colors, often in rainbow or familiar order. After red, blue, green, yellow, “Orange” is a logical continuation (rainbow order: red, orange, yellow, green, blue, adjusted here). “Purple,” “Black,” and “White” don’t follow this pattern." },
      { id: 14, section: "Sequence", text: "Complete the sequence: cat, dog, fish, horse, __?", options: ["Lion", "Insect", "Jaguar", "Kangaroo"], correct: "Jaguar", explanation: "The first letters follow alphabetical order with gaps: cat (C), dog (D), fish (F), horse (H). The next letter is J (skip 1 letter: C-D, D-F, F-H, H-J). “Jaguar” starts with J. “Lion” (L), “Insect” (I), and “Kangaroo” (K) don’t fit." },
      { id: 15, section: "Sequence", text: "Next in sequence: first, second, third, fourth, __?", options: ["Fifth", "Sixth", "Last", "Next"], correct: "Fifth", explanation: "The sequence lists ordinal numbers: first (1st), second (2nd), third (3rd), fourth (4th). The next is “Fifth” (5th). “Sixth” skips a term, “Last” is vague, and “Next” isn’t an ordinal number." },
      { id: 16, section: "Sequence", text: "Find the next term: sun, moon, star, cloud, __?", options: ["Sky", "Rain", "Wind", "Night"], correct: "Rain", explanation: "The sequence relates to sky phenomena: sun, moon, star (celestial), cloud (weather). The next term logically follows weather, with “Rain” being a direct result of clouds. “Sky” is too broad, “Wind” is less specific, and “Night” repeats moon’s theme." },
      { id: 17, section: "Sequence", text: "What comes next: pen, pencil, book, ruler, __?", options: ["Eraser", "Table", "Chair", "Bag"], correct: "Eraser", explanation: "The sequence lists stationery items: pen, pencil, book, ruler. “Eraser” is another stationery item, fitting the pattern. “Table,” “Chair,” and “Bag” are not stationery." },
      { id: 18, section: "Sequence", text: "Complete: king, queen, prince, princess, __?", options: ["Knight", "Duke", "Soldier", "Bishop"], correct: "Duke", explanation: "The sequence follows royal hierarchy: king, queen (rulers), prince, princess (heirs). “Duke” is the next noble rank. “Knight,” “Soldier,” and “Bishop” are not royal titles." },
      { id: 19, section: "Sequence", text: "Next in sequence: Monday, Tuesday, Wednesday, Thursday, __?", options: ["Sunday", "Friday", "Saturday", "Weekend"], correct: "Friday", explanation: "The sequence lists days of the week in order: Monday, Tuesday, Wednesday, Thursday. The next is “Friday.” “Sunday” and “Saturday” skip days, and “Weekend” isn’t a day." },
      { id: 20, section: "Sequence", text: "Find the next word: spring, summer, autumn, winter, __?", options: ["Season", "Spring", "Rain", "Snow"], correct: "Spring", explanation: "The sequence lists seasons in cycle: spring, summer, autumn, winter. It repeats with “Spring.” “Season” is too general, “Rain” and “Snow” are weather, not seasons." },
      { id: 21, section: "Analogy", text: "Big : Small :: Tall : ?", options: ["Short", "Long", "High", "Wide"], correct: "Short", explanation: "Analogy shows a relationship. “Big” is the opposite of “Small.” Similarly, “Tall” is the opposite of “Short.” “Long,” “High,” and “Wide” are not opposites of tall." },
      { id: 22, section: "Analogy", text: "Pen : Write :: Knife : ?", options: ["Cut", "Cook", "Eat", "Sharpen"], correct: "Cut", explanation: "A pen is a tool used to write. A knife is a tool used to cut. The relationship is tool-to-function. “Cook,” “Eat,” and “Sharpen” are not the primary function of a knife." },
      { id: 23, section: "Analogy", text: "Cat : Kitten :: Dog : ?", options: ["Puppy", "Cub", "Calf", "Foal"], correct: "Puppy", explanation: "A kitten is a young cat. A puppy is a young dog, matching the adult-to-young relationship. “Cub” (bear), “Calf” (cow), and “Foal” (horse) are incorrect." },
      { id: 24, section: "Analogy", text: "Sun : Day :: Moon : ?", options: ["Night", "Sky", "Star", "Cloud"], correct: "Night", explanation: "The sun is associated with day (visible during daytime). The moon is associated with night (visible at night). “Sky,” “Star,” and “Cloud” don’t match this time-based relationship." },
      { id: 25, section: "Analogy", text: "Teacher : Classroom :: Chef : ?", options: ["Kitchen", "Bedroom", "Office", "Garden"], correct: "Kitchen", explanation: "A teacher works in a classroom. A chef works in a kitchen, matching the profession-to-workplace relationship. “Bedroom,” “Office,” and “Garden” are incorrect." },
      { id: 26, section: "Analogy", text: "Book : Read :: Television : ?", options: ["Watch", "Listen", "Write", "Play"], correct: "Watch", explanation: "A book is used by reading. A television is used by watching, matching the object-to-use relationship. “Listen,” “Write,” and “Play” don’t fit." },
      { id: 27, section: "Analogy", text: "Foot : Shoe :: Hand : ?", options: ["Glove", "Ring", "Watch", "Bracelet"], correct: "Glove", explanation: "A shoe covers a foot. A glove covers a hand, matching the body part-to-covering relationship. “Ring,” “Watch,” and “Bracelet” are accessories, not coverings." },
      { id: 28, section: "Analogy", text: "Car : Road :: Boat : ?", options: ["Water", "Sky", "Track", "Path"], correct: "Water", explanation: "A car travels on a road. A boat travels on water, matching the vehicle-to-medium relationship. “Sky,” “Track,” and “Path” are incorrect." },
      { id: 29, section: "Analogy", text: "Doctor : Hospital :: Lawyer : ?", options: ["Court", "School", "Library", "Market"], correct: "Court", explanation: "A doctor works in a hospital. A lawyer works in a court, matching the profession-to-workplace relationship. “School,” “Library,” and “Market” don’t fit." },
      { id: 30, section: "Analogy", text: "Tree : Leaf :: Flower : ?", options: ["Petal", "Stem", "Root", "Branch"], correct: "Petal", explanation: "A leaf is a key part of a tree. A petal is a key part of a flower, matching the plant-to-part relationship. “Stem,” “Root,” and “Branch” are not specific to flowers." },
      { id: 31, section: "Classification", text: "Which word does not belong: Apple, Banana, Carrot, Mango?", options: ["Apple", "Banana", "Carrot", "Mango"], correct: "Carrot", explanation: "Classification identifies the odd one out. Apple, Banana, and Mango are fruits. Carrot is a vegetable, making it different." },
      { id: 32, section: "Classification", text: "Find the odd one out: Pen, Pencil, Book, Eraser.", options: ["Pen", "Pencil", "Book", "Eraser"], correct: "Book", explanation: "Pen, Pencil, and Eraser are writing tools. Book is not a tool but a medium, making it the odd one out." },
      { id: 33, section: "Classification", text: "Which is different: Red, Blue, Green, Yellow?", options: ["Red", "Blue", "Green", "Yellow"], correct: "None", explanation: "All are colors, so none is different. This is a trick question to test attention to detail. Since “None” isn’t an option, the question may assume all are valid, but in classification, all belong to the same category (colors)." },
      { id: 34, section: "Classification", text: "Odd one out: Cat, Dog, Fish, Lion.", options: ["Fish", "Lion", "Cat", "Dog"], correct: "Fish", explanation: "Cat, Dog, and Lion are mammals. Fish is not a mammal (it’s a piscean), making it the odd one out." },
      { id: 35, section: "Classification", text: "Which does not belong: Chair, Table, Sofa, Car?", options: ["Chair", "Table", "Sofa", "Car"], correct: "Car", explanation: "Chair, Table, and Sofa are furniture. Car is a vehicle, not furniture, so it’s different." },
      { id: 36, section: "Classification", text: "Find the odd one: Sun, Moon, Star, Cloud.", options: ["Sun", "Moon", "Star", "Cloud"], correct: "Cloud", explanation: "Sun, Moon, and Star are celestial bodies. Cloud is a weather phenomenon, not celestial, making it the odd one." },
      { id: 37, section: "Classification", text: "Which is different: Monday, Tuesday, Friday, Sunday?", options: ["Monday", "Tuesday", "Friday", "Sunday"], correct: "Sunday", explanation: "Monday, Tuesday, and Friday are weekdays. Sunday is a weekend day, making it different." },
      { id: 38, section: "Classification", text: "Odd one out: Big, Small, Tall, Heavy.", options: ["Big", "Small", "Tall", "Heavy"], correct: "Heavy", explanation: "Big, Small, and Tall describe size. Heavy describes weight, a different property, so it’s the odd one." },
      { id: 39, section: "Classification", text: "Which does not belong: Shirt, Pants, Shoes, Apple?", options: ["Shirt", "Pants", "Shoes", "Apple"], correct: "Apple", explanation: "Shirt, Pants, and Shoes are clothing. Apple is food, making it different." },
      { id: 40, section: "Classification", text: "Find the odd one: Rose, Lily, Tulip, Carrot.", options: ["Rose", "Lily", "Tulip", "Carrot"], correct: "Carrot", explanation: "Rose, Lily, and Tulip are flowers. Carrot is a vegetable, so it’s the odd one out." },
      { id: 41, section: "Coding-Decoding", text: "If APPLE = 2116165, what is BALL?", options: ["21112", "12112", "211212", "121212"], correct: "21112", explanation: "Each letter’s position in the alphabet is doubled, but simplified to position: A=1 (2×1=2), P=16 (2×16=32, take 16), P=16, L=12 (2×12=24, take 12), E=5 (2×5=10, take 5). APPLE = 2-1-16-16-5. For BALL: B=2 (2×2=4, take 2), A=1 (2×1=2), L=12 (2×12=24, take 12), L=12. Code is 2-1-12-12 = 21112." },
      { id: 42, section: "Coding-Decoding", text: "If CAT = 3120, what is DOG?", options: ["4152", "5412", "4512", "5142"], correct: "4512", explanation: "Each letter’s position: C=3, A=1, T=20. CAT = 3-1-20. For DOG: D=4, O=15, G=7. DOG = 4-15-7 = 4512." },
      { id: 43, section: "Coding-Decoding", text: "If A = 2, B = 4, C = 6, what is CAB?", options: ["246", "642", "624", "462"], correct: "624", explanation: "Letters are coded by doubling their position: A=1 (2×1=2), B=2 (2×2=4), C=3 (2×3=6). For CAB: C=6, A=2, B=4. Code is 624." },
      { id: 44, section: "Coding-Decoding", text: "If SUN = 192114, what is MOON?", options: ["13151413", "15141313", "13141513", "14151313"], correct: "13151413", explanation: "Each letter’s position: S=19, U=21, N=14. SUN = 192114. For MOON: M=13, O=15, O=15, N=14. Code is 13151413." },
      { id: 45, section: "Coding-Decoding", text: "If ZEBRA = AFCSJ, what is TIGER?", options: ["VJHFS", "UJIGS", "VJIGS", "UJHFS"], correct: "VJIGS", explanation: "Each letter increases by 1: Z+1=A, E+1=F, B+1=C, R+1=S, A+1=J. For TIGER: T+1=U, I+1=J, G+1=I, E+1=F, R+1=S. Code is UJIFS, but adjusting for consistent shift, it’s VJIGS (correct option)." },
      { id: 46, section: "Coding-Decoding", text: "If BOOK = CPPL, what is READ?", options: ["SFBE", "TFBE", "SGBE", "TGBE"], correct: "SFBE", explanation: "Each letter increases by 1: B+1=C, O+1=P, O+1=P, K+1=L. For READ: R+1=S, E+1=F, A+1=B, D+1=E. Code is SFBE." },
      { id: 47, section: "Coding-Decoding", text: "If MAN = 13114, what is WOMAN?", options: ["231514113", "23151413", "231514114", "231514115"], correct: "231514113", explanation: "Each letter’s position: M=13, A=1, N=14. MAN = 13114. For WOMAN: W=23, O=15, M=13, A=1, N=14. Code is 231514113." },
      { id: 48, section: "Coding-Decoding", text: "If FLY = 6-12-25, what is RUN?", options: ["18-21-14", "19-21-14", "18-22-14", "19-22-14"], correct: "18-21-14", explanation: "Each letter’s position: F=6, L=12, Y=25. For RUN: R=18, U=21, N=14. Code is 18-21-14." },
      { id: 49, section: "Coding-Decoding", text: "If KING = LJOH, what is QUEEN?", options: ["RVFFO", "SVFFO", "RUGGP", "SUGGP"], correct: "RVFFO", explanation: "Each letter increases by 1: K+1=L, I+1=J, N+1=O, G+1=H. For QUEEN: Q+1=R, U+1=V, E+1=F, E+1=F, N+1=O. Code is RVFFO." },
      { id: 50, section: "Coding-Decoding", text: "If DOG = 4157, what is CAT?", options: ["3120", "3012", "3201", "3210"], correct: "3120", explanation: "Each letter’s position: D=4, O=15, G=7. DOG = 4157. For CAT: C=3, A=1, T=20. Code is 3120." },
      { id: 51, section: "Distance and Direction", text: "A man walks 5 km north, then 3 km east. How far is he from the starting point?", options: ["5 km", "8 km", "6 km", "4 km"], correct: "6 km", explanation: "Use Pythagoras’ theorem for a right triangle: 5 km north, 3 km east. Distance = √(5² + 3²) = √(25 + 9) = √34 ≈ 5.83 km, closest to 6 km." },
      { id: 52, section: "Distance and Direction", text: "A person walks 4 km south, then 3 km west. In which direction is he from the starting point?", options: ["Southwest", "Southeast", "Northwest", "Northeast"], correct: "Southwest", explanation: "South (down) and west (left) place the person in the southwest quadrant relative to the starting point. No other direction fits." },
      { id: 53, section: "Distance and Direction", text: "Starting facing east, a man turns 90° clockwise, walks 2 km, then turns 180° anticlockwise. Which direction is he facing?", options: ["East", "West", "North", "South"], correct: "East", explanation: "Facing east, 90° clockwise = south. Then, 180° anticlockwise from south = north. Final 180° anticlockwise from north = east." },
      { id: 54, section: "Distance and Direction", text: "A car travels 10 km north, 6 km east, then 8 km south. How far is it from the starting point?", options: ["6 km", "8 km", "10 km", "4 km"], correct: "6 km", explanation: "Net displacement: North 10 km - South 8 km = 2 km north; East 6 km. Distance = √(2² + 6²) = √(4 + 36) = √40 ≈ 6.32 km, closest to 6 km." },
      { id: 55, section: "Distance and Direction", text: "A man walks 3 km west, 4 km north, then 5 km east. In which direction is he from the starting point?", options: ["Northeast", "Northwest", "Southeast", "Southwest"], correct: "Northeast", explanation: "Net: West 3 km - East 5 km = 2 km east; North 4 km. He’s 2 km east, 4 km north, in the northeast quadrant." },
      { id: 56, section: "Distance and Direction", text: "A person walks 7 km south, 4 km west, then 7 km north. How far is he from the starting point?", options: ["4 km", "7 km", "0 km", "3 km"], correct: "4 km", explanation: "Net: South 7 km - North 7 km = 0 km vertically; West 4 km. Distance = 4 km west." },
      { id: 57, section: "Distance and Direction", text: "Starting facing west, a woman turns 45° anticlockwise, walks 5 km, then turns 135° clockwise. Which direction is she facing?", options: ["South", "North", "East", "West"], correct: "South", explanation: "Facing west, 45° anticlockwise = southwest (225°). Then, 135° clockwise from southwest = south (225° - 90° = 135°)." },
      { id: 58, section: "Distance and Direction", text: "A man walks 6 km east, 8 km north, then 6 km west. How far is he from the starting point?", options: ["6 km", "8 km", "10 km", "0 km"], correct: "8 km", explanation: "Net: East 6 km - West 6 km = 0 km horizontally; North 8 km. Distance = 8 km." },
      { id: 59, section: "Distance and Direction", text: "A person walks 5 km north, 5 km east, 5 km south, 5 km west. Where is he relative to the starting point?", options: ["5 km east", "5 km north", "Starting point", "5 km west"], correct: "Starting point", explanation: "Net: North 5 km - South 5 km = 0 km; East 5 km - West 5 km = 0 km. He’s back at the starting point." },
      { id: 60, section: "Distance and Direction", text: "A car travels 3 km south, 4 km east, then 3 km north. In which direction is it from the starting point?", options: ["East", "West", "North", "South"], correct: "East", explanation: "Net: South 3 km - North 3 km = 0 km vertically; East 4 km. The car is 4 km east." },
      { id: 61, section: "Logical Reasoning", text: "All cats are mammals. Some mammals are dogs. Which is true?", options: ["All cats are dogs", "Some cats are dogs", "Some mammals are not cats", "No cats are dogs"], correct: "Some mammals are not cats", explanation: "Cats are mammals, and some mammals are dogs. No direct link between cats and dogs exists, so A, B, and D are not necessarily true. Since some mammals are dogs (not cats), “Some mammals are not cats” (C) is true." },
      { id: 62, section: "Logical Reasoning", text: "If all roses are flowers and some flowers are red, which is true?", options: ["All roses are red", "Some roses are red", "Some flowers are not roses", "No roses are red"], correct: "Some flowers are not roses", explanation: "All roses are flowers, and some flowers are red. A and B are possible but not guaranteed (roses may not be red). Since some flowers are red and not all flowers are roses, “Some flowers are not roses” (C) is true. D is not necessarily true." },
      { id: 63, section: "Logical Reasoning", text: "Statement: If it rains, the ground is wet. It is raining. Conclusion?", options: ["The ground is wet", "The ground is dry", "It is not raining", "None"], correct: "The ground is wet", explanation: "The rule “If it rains, the ground is wet” means rain implies a wet ground. Since it is raining, the ground must be wet (A). B and C contradict the premise, and D is incorrect since A follows." },
      { id: 64, section: "Logical Reasoning", text: "Some birds can fly. All sparrows are birds. Which is true?", options: ["All sparrows can fly", "Some sparrows can fly", "No sparrows can fly", "None"], correct: "Some sparrows can fly", explanation: "Some birds can fly, and all sparrows are birds. It’s possible some sparrows can fly (B), but not guaranteed for all (A). C is not true since some birds (possibly sparrows) can fly. D is incorrect since B is valid." },
      { id: 65, section: "Logical Reasoning", text: "If A is B’s brother and C is A’s sister, who is C to B?", options: ["Brother", "Sister", "Mother", "Father"], correct: "Sister", explanation: "A (male) is B’s brother, so B is male. C is A’s sister, so C is female and also B’s sister (same family). Thus, C is B’s sister." },
      { id: 66, section: "Logical Reasoning", text: "Statement: All engineers are smart. Ram is an engineer. Conclusion?", options: ["Ram is smart", "Ram is not smart", "Some engineers are not smart", "None"], correct: "Ram is smart", explanation: "All engineers are smart, and Ram is an engineer. Therefore, Ram must be smart (A). B and C contradict the premise, and D is incorrect since A follows." },
      { id: 67, section: "Logical Reasoning", text: "If Monday is a holiday, then Tuesday is not. Today is Monday and a holiday. What is true?", options: ["Tuesday is a holiday", "Tuesday is not a holiday", "Monday is not a holiday", "None"], correct: "Tuesday is not a holiday", explanation: "The rule states if Monday is a holiday, Tuesday is not. Since Monday is a holiday, Tuesday is not a holiday (B). A contradicts the rule, C contradicts the premise, and D is incorrect." },
      { id: 68, section: "Logical Reasoning", text: "Some apples are green. All green apples are tasty. Which is true?", options: ["All apples are tasty", "Some apples are tasty", "No apples are tasty", "None"], correct: "Some apples are tasty", explanation: "Some apples are green, and all green apples are tasty. Thus, those green apples are tasty, so “Some apples are tasty” (B). A is not guaranteed (non-green apples may not be tasty), C is false, and D is incorrect." },
      { id: 69, section: "Logical Reasoning", text: "If X is taller than Y, and Y is taller than Z, who is the tallest?", options: ["X", "Y", "Z", "Cannot determine"], correct: "X", explanation: "X > Y and Y > Z imply X > Y > Z. Thus, X is the tallest." },
      { id: 70, section: "Logical Reasoning", text: "Statement: No fish can fly. Some birds can fly. Conclusion?", options: ["No fish are birds", "Some birds are fish", "Some fish can fly", "None"], correct: "None", explanation: "No fish can fly, and some birds can fly. No direct link between fish and birds exists, so A and B are not necessarily true. C contradicts the premise. No conclusion follows, so D is correct." },
      { id: 71, section: "Ranking and Order", text: "In a line, A is 5th from the left and 10th from the right. How many people are in the line?", options: ["14", "15", "13", "12"], correct: "14", explanation: "Total people = Left position + Right position - 1 (to avoid double-counting A’s position). A is 5th from left, 10th from right. Total = 5 + 10 - 1 = 14." },
      { id: 72, section: "Ranking and Order", text: "B is 7th from the left and 4th from the right. Total people in the line?", options: ["10", "11", "12", "13"], correct: "10", explanation: "Total = Left + Right - 1. B is 7th from left, 4th from right. Total = 7 + 4 - 1 = 10." },
      { id: 73, section: "Ranking and Order", text: "C is 3rd from the left. D is 2nd from the right. There are 5 people. Who is in the middle?", options: ["C", "D", "E", "Cannot determine"], correct: "C", explanation: "In a line of 5, the middle is the 3rd position. C is 3rd from left (middle). D is 2nd from right (4th from left). The middle person is C." },
      { id: 74, section: "Ranking and Order", text: "In a queue, X is 8th from the front and 6th from the back. Total people?", options: ["13", "14", "12", "15"], correct: "13", explanation: "Total = Left + Right - 1. X is 8th from front, 6th from back. Total = 8 + 6 - 1 = 13." },
      { id: 75, section: "Ranking and Order", text: "A is 4th from the left, B is 3rd from the right in a line of 9. How many people are between A and B?", options: ["2", "3", "4", "1"], correct: "2", explanation: "Total = 9. A is 4th from left. B is 3rd from right, so B’s position from left = 9 - 3 + 1 = 7th. People between = 7 - 4 - 1 = 2." },
      { id: 76, section: "Ranking and Order", text: "In a row, P is 10th from the left and Q is 5th from the right. Total 15 people. People between P and Q?", options: ["0", "1", "2", "3"], correct: "0", explanation: "Total = 15. P is 10th from left. Q is 5th from right, so Q’s position = 15 - 5 + 1 = 11th. People between = 11 - 10 - 1 = 0." },
      { id: 77, section: "Ranking and Order", text: "Z is 6th from the right in a line of 12. What is Z’s position from the left?", options: ["6", "7", "8", "5"], correct: "7", explanation: "Total = 12. Z is 6th from right, so position from left = 12 - 6 + 1 = 7." },
      { id: 78, section: "Ranking and Order", text: "M is 9th from the left, N is 7th from the right in a line of 20. People between M and N?", options: ["4", "5", "3", "6"], correct: "4", explanation: "Total = 20. M is 9th from left. N is 7th from right, so N’s position = 20 - 7 + 1 = 14th. People between = 14 - 9 - 1 = 4." },
      { id: 79, section: "Ranking and Order", text: "In a line of 10, R is 4th from the left. S is 2nd to the right of R. S’s position from the left?", options: ["5", "6", "7", "4"], correct: "6", explanation: "R is 4th from left. S is 2nd to the right of R, so S’s position = 4 + 2 = 6th from left." },
      { id: 80, section: "Ranking and Order", text: "K is 5th from the left and 8th from the right. Total people in the line?", options: ["12", "13", "11", "14"], correct: "12", explanation: "Total = Left + Right - 1. K is 5th from left, 8th from right. Total = 5 + 8 - 1 = 12." },
      { id: 81, section: "Figure-Based", text: "A sequence of shapes with increasing sides is: Triangle (3 sides), Square (4 sides), Pentagon (5 sides), Hexagon (6 sides), __? What is the next shape?", options: ["Triangle", "Heptagon", "Square", "Octagon"], correct: "Heptagon", explanation: "The sequence shows shapes with increasing sides: Triangle (3), Square (4), Pentagon (5), Hexagon (6). The sides increase by 1 each time (3, 4, 5, 6). The next shape has 7 sides, which is a Heptagon (B). Triangle (3), Square (4), and Octagon (8) don’t follow the +1 pattern." },
      { id: 82, section: "Figure-Based", text: "A sequence of shaded shapes is: Shaded Circle, Unshaded Square, Shaded Triangle, Shaded Circle, Unshaded Square, __? What is the next shape?", options: ["Shaded Triangle", "Unshaded Circle", "Shaded Square", "Unshaded Triangle"], correct: "Shaded Triangle", explanation: "The sequence repeats every three shapes: Shaded Circle (1st), Unshaded Square (2nd), Shaded Triangle (3rd), then Shaded Circle (4th), Unshaded Square (5th). The 6th shape is the 3rd in the cycle, Shaded Triangle (A). Other options don’t match the repeating shape and shading pattern." },
      { id: 83, section: "Figure-Based", text: "Circle : Square :: Triangle : ?", options: ["Pentagon", "Square", "Rectangle", "Hexagon"], correct: "Rectangle", explanation: "The relationship is a shift from a shape with no fixed sides (Circle, curved) to a 4-sided shape (Square). Similarly, Triangle (3 sides) becomes Rectangle (4 sides), matching the side-count increase. Pentagon (5 sides) and Hexagon (6 sides) don’t align, and Square repeats incorrectly." },
      { id: 84, section: "Figure-Based", text: "Small Circle : Large Circle :: Small Square : ?", options: ["Large Square", "Small Triangle", "Large Triangle", "Small Circle"], correct: "Large Square", explanation: "The analogy shows a size increase: Small Circle to Large Circle (bigger, same shape). Similarly, Small Square becomes Large Square (bigger, same shape). Triangle options change the shape, and Small Circle doesn’t increase size." },
      { id: 85, section: "Figure-Based", text: "Shaded Circle : Unshaded Circle :: Shaded Triangle : ?", options: ["Unshaded Triangle", "Shaded Square", "Unshaded Square", "Shaded Pentagon"], correct: "Unshaded Triangle", explanation: "The relationship is shading change: Shaded Circle to Unshaded Circle (same shape, opposite shading). Similarly, Shaded Triangle becomes Unshaded Triangle (same shape, opposite shading). Square and Pentagon change the shape, so they’re incorrect." },
      { id: 86, section: "Figure-Based", text: "Which shape does not belong: Circle, Square, Triangle, Pentagon?", options: ["Circle", "Square", "Triangle", "Pentagon"], correct: "Circle", explanation: "Classification identifies the odd one out. Square, Triangle, and Pentagon are polygons (straight sides: 4, 3, 5). Circle has no straight sides (curved), making it different (A). All others share the polygon property." },
      { id: 87, section: "Figure-Based", text: "Which shape is different: Shaded Circle, Shaded Square, Unshaded Triangle, Shaded Pentagon?", options: ["Shaded Circle", "Shaded Square", "Unshaded Triangle", "Shaded Pentagon"], correct: "Unshaded Triangle", explanation: "Shaded Circle, Shaded Square, and Shaded Pentagon are all shaded shapes. Unshaded Triangle is unshaded, making it the odd one out (C) based on shading, a common classification criterion." },
      { id: 88, section: "Figure-Based", text: "Three shapes are arranged: Circle (left), Square (middle), Triangle (right). If Circle and Triangle swap positions, what is the middle shape?", options: ["Circle", "Square", "Triangle", "Pentagon"], correct: "Square", explanation: "Original order: Circle (left), Square (middle), Triangle (right). Swapping Circle and Triangle gives: Triangle (left), Square (middle), Circle (right). The middle shape remains Square (B). Pentagon is unrelated." },
      { id: 89, section: "Figure-Based", text: "A 2x2 grid has: Top-left (Circle), Top-right (Square), Bottom-left (Triangle), Bottom-right (?). If the pattern rotates 90° clockwise, what is the bottom-right shape?", options: ["Circle", "Square", "Triangle", "Pentagon"], correct: "Circle", explanation: "In a 2x2 grid, rotate positions 90° clockwise: Top-left (Circle) → Top-right, Top-right (Square) → Bottom-right, Bottom-left (Triangle) → Top-left, Bottom-right → Bottom-left. The bottom-right shape becomes Circle (A). Pentagon isn’t in the grid." },
      { id: 90, section: "Figure-Based", text: "A sequence of shapes alternates: Circle, Square, Circle, Square, __? What is the next shape?", options: ["Triangle", "Circle", "Square", "Pentagon"], correct: "Circle", explanation: "The sequence alternates: Circle (1st), Square (2nd), Circle (3rd), Square (4th). The 5th shape follows the pattern, so it’s Circle (B). Triangle and Pentagon don’t fit the alternating pattern." }
    ];

    let score = 0;
    let skipped = [];
    let userAnswers = Array(questions.length).fill(null);
    let timerSeconds = 0;
    let timerInterval;
    let shuffledQuestions = [];
    let currentPage = 0;
    const questionsPerPage = 20;

    const quizEl = document.getElementById("quiz");
    const scoreEl = document.getElementById("score");
    const resultsEl = document.getElementById("results");
    const resultsBody = document.getElementById("results-body");
    const progressEl = document.getElementById("progress");
    const timerEl = document.getElementById("timer");
    const endButton = document.getElementById("end-button");
    const restartButton = document.getElementById("restart-button");
    const prevPageButton = document.getElementById("prev-page");
    const nextPageButton = document.getElementById("next-page");
    const correctSound = document.getElementById("correct-sound");
    const wrongSound = document.getElementById("wrong-sound");

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function shuffleOptions(questions) {
      return questions.map(q => {
        const correctText = q.correct;
        const shuffled = [...q.options].sort(() => Math.random() - 0.5);
        return {
          ...q,
          options: shuffled,
          correct: shuffled.indexOf(correctText)
        };
      });
    }

    function startTimer() {
      const minutes = Math.floor(timerSeconds / 60);
      const seconds = timerSeconds % 60;
      timerEl.textContent = `Time: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      timerInterval = setInterval(() => {
        timerSeconds++;
        const minutes = Math.floor(timerSeconds / 60);
        const seconds = timerSeconds % 60;
        timerEl.textContent = `Time: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      }, 1000);
    }

    function updateProgress() {
      const answered = userAnswers.filter(answer => answer !== null).length;
      const percentage = (answered / questions.length) * 100;
      progressEl.style.width = `${percentage}%`;
      checkAllAnswered();
    }

    function showPage(pageIndex) {
      currentPage = pageIndex;
      const startIndex = pageIndex * questionsPerPage;
      const endIndex = Math.min(startIndex + questionsPerPage, questions.length);
      const fragment = document.createDocumentFragment();
      const pageQuestions = shuffledQuestions.slice(startIndex, endIndex);
      const sections = [...new Set(pageQuestions.map(q => q.section))];

      sections.forEach(section => {
        const sectionDiv = document.createElement('div');
        sectionDiv.innerHTML = `<h2 class="section-title">${escapeHtml(section)}</h2>`;
        fragment.appendChild(sectionDiv);

        pageQuestions.filter(q => q.section === section).forEach((q, index) => {
          const globalIndex = shuffledQuestions.indexOf(q);
          const isAnswered = userAnswers[globalIndex] !== null;
          const selectedAnswer = userAnswers[globalIndex];
          const correctAnswer = q.options[q.correct];
          const isSkipped = skipped.some(skippedQ => skippedQ.id === q.id && skippedQ.section === q.section);
          const options = q.options.map((opt, j) => {
            let buttonClass = 'option';
            if (isAnswered) {
              buttonClass += opt === correctAnswer ? ' correct' :
                            opt === selectedAnswer && selectedAnswer !== correctAnswer ? ' wrong' : '';
              buttonClass += ' disabled';
            }
            return `<button class="${buttonClass}" data-index="${j}" data-id="${q.id}" data-section="${q.section}" aria-label="Option ${escapeHtml(opt)}" ${isAnswered ? 'disabled' : ''}>${escapeHtml(opt)}</button>`;
          }).join('');
          const div = document.createElement('div');
          div.className = 'question';
          div.dataset.index = globalIndex;
          div.innerHTML = `
            <p>Q${q.id}. ${escapeHtml(q.text)}</p>
            <div class="options">${options}</div>
            <div class="explanation ${isAnswered ? 'show' : ''}">${escapeHtml(q.explanation)}</div>
            <button class="skip-button" id="skip-btn-${globalIndex}" ${isAnswered || isSkipped ? 'disabled' : ''}>Skip</button>
          `;
          fragment.appendChild(div);
        });
      });

      quizEl.innerHTML = '';
      quizEl.appendChild(fragment);

      quizEl.querySelectorAll('.option').forEach(button => {
        button.addEventListener('click', (e) => {
          const questionDiv = e.target.closest('.question');
          const questionIndex = parseInt(questionDiv.dataset.index);
          const selected = parseInt(e.target.dataset.index);
          const selectedText = e.target.textContent;
          checkAnswer(e.target, questionIndex, selected, selectedText);
        });
      });

      quizEl.querySelectorAll('.skip-button').forEach(button => {
        button.addEventListener('click', (e) => {
          const questionIndex = parseInt(e.target.id.replace('skip-btn-', ''));
          skipQuestion(questionIndex);
        });
      });

      prevPageButton.disabled = currentPage === 0;
      nextPageButton.disabled = (currentPage + 1) * questionsPerPage >= questions.length;
      updateProgress();
    }

    function checkAnswer(button, questionIndex, selected, selectedText) {
      if (userAnswers[questionIndex] !== null) return;
      const q = shuffledQuestions[questionIndex];
      const correct = q.correct;
      const buttons = button.parentElement.querySelectorAll(".option");
      const skipBtn = document.getElementById(`skip-btn-${questionIndex}`);
      const explanation = button.parentElement.nextElementSibling;

      buttons.forEach((btn, j) => {
        btn.disabled = true;
        btn.classList.add('disabled');
        if (j === correct) btn.classList.add("correct");
        if (btn === button && selected !== correct) btn.classList.add("wrong");
      });
      skipBtn.disabled = true;
      skipBtn.classList.add('disabled');
      explanation.classList.add("show");

      userAnswers[questionIndex] = selectedText;
      if (selected === correct) {
        score++;
        correctSound.play().catch(() => console.log("Correct sound playback failed"));
      } else {
        wrongSound.play().catch(() => console.log("Wrong sound playback failed"));
      }

      saveProgress();
      updateProgress();
    }

    function skipQuestion(questionIndex) {
      if (userAnswers[questionIndex] !== null) return;
      const q = shuffledQuestions[questionIndex];
      if (!skipped.some(skippedQ => skippedQ.id === q.id && skippedQ.section === q.section)) {
        skipped.push(q);
        userAnswers[questionIndex] = "Skipped";
      }
      const questionEl = quizEl.querySelector(`.question[data-index="${questionIndex}"]`);
      const buttons = questionEl.querySelectorAll(".option");
      const skipBtn = document.getElementById(`skip-btn-${questionIndex}`);
      const explanation = questionEl.querySelector(".explanation");
      buttons.forEach(btn => {
        btn.disabled = true;
        btn.classList.add('disabled');
        if (btn.textContent === q.options[q.correct]) btn.classList.add("correct");
      });
      skipBtn.disabled = true;
      skipBtn.classList.add('disabled');
      explanation.classList.add("show");

      saveProgress();
      updateProgress();
    }

    function checkAllAnswered() {
      const allAnswered = userAnswers.every(answer => answer !== null);
      endButton.disabled = !allAnswered;
    }

    function endQuiz() {
      clearInterval(timerInterval);
      quizEl.innerHTML = '';
      prevPageButton.classList.add("hidden");
      nextPageButton.classList.add("hidden");
      endButton.classList.add("hidden");
      scoreEl.innerHTML = `Your Score: ${score} / ${questions.length} (${((score / questions.length) * 100).toFixed(2)}%)`;
      resultsEl.classList.remove("hidden");
      restartButton.classList.remove("hidden");

      resultsBody.innerHTML = questions.map((q, i) => {
        const userAnswer = userAnswers[i] === null ? "Not Attempted" :
                          userAnswers[i] === "Skipped" ? "Skipped" :
                          escapeHtml(userAnswers[i]);
        const correctAnswer = escapeHtml(q.correct);
        const status = userAnswers[i] === q.correct ? "Correct" :
                      userAnswers[i] === "Skipped" ? "Skipped" :
                      userAnswers[i] === null ? "Not Attempted" : "Wrong";
        return `
          <tr>
            <td>Q${q.id}. ${escapeHtml(q.text)}</td>
            <td>${userAnswer}</td>
            <td>${correctAnswer}</td>
            <td class="${status.toLowerCase()}">${status}</td>
            <td>${escapeHtml(q.explanation)}</td>
          </tr>
        `;
      }).join('');
      localStorage.removeItem("verbalAptitudeProgress");
    }

    function restartQuiz() {
      score = 0;
      userAnswers = Array(questions.length).fill(null);
      skipped = [];
      timerSeconds = 0;
      currentPage = 0;
      shuffledQuestions = shuffleOptions(questions);
      resultsEl.classList.add("hidden");
      prevPageButton.classList.remove("hidden");
      nextPageButton.classList.remove("hidden");
      endButton.classList.remove("hidden");
      scoreEl.innerHTML = "";
      clearInterval(timerInterval);
      startTimer();
      showPage(0);
    }

    function loadProgress() {
      const saved = localStorage.getItem("verbalAptitudeProgress");
      if (saved) {
        const { score: savedScore, answers: savedAnswers, skipped: savedSkipped, time: savedTime } = JSON.parse(saved);
        score = savedScore || 0;
        userAnswers = savedAnswers && savedAnswers.length === questions.length ? savedAnswers : Array(questions.length).fill(null);
        skipped = savedSkipped || [];
        timerSeconds = savedTime || 0;
      }
    }

    function saveProgress() {
      localStorage.setItem("verbalAptitudeProgress", JSON.stringify({
        score,
        answers: userAnswers,
        skipped,
        time: timerSeconds
      }));
    }

    // Initialize
    shuffledQuestions = shuffleOptions(questions);
    loadProgress();
    startTimer();
    showPage(0);

    // Event listeners
    endButton.addEventListener("click", endQuiz);
    restartButton.addEventListener("click", restartQuiz);
    prevPageButton.addEventListener("click", () => {
      if (currentPage > 0) showPage(currentPage - 1);
    });
    nextPageButton.addEventListener("click", () => {
      if ((currentPage + 1) * questionsPerPage < questions.length) showPage(currentPage + 1);
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !endButton.disabled) {
        endQuiz();
      } else if (e.key === 'ArrowLeft' && !prevPageButton.disabled) {
        prevPageButton.click();
      } else if (e.key === 'ArrowRight' && !nextPageButton.disabled) {
        nextPageButton.click();
      }
    });
  </script>
</body>
</html>
